import{a as K,aT as O,a0 as ae,E as U,d as I,ah as ne,au as q,a2 as he,i as X,r as P,aq as W,h as R,k as E,c5 as ie,bm as H,ad as fe,a3 as pe,a4 as re,a6 as be,aJ as ve,Y as J,al as le,ak as Y,c6 as se,j as V,c7 as ge,I as M,l as L,c8 as ye,n as oe,ao as $,A as G,a5 as Q,c9 as Ce,F as de,ap as Ie,e as z,p as ue,q as j,R as Ve,C as Z,c4 as ee,b0 as Ae,ca as me,w as Ne,cb as Se,cc as xe,cd as Fe,as as ke,aj as Be}from"./index-26b02238.js";function ce(B,u){return u.reduce(function(t,e){return t[e]=Ae(e,B),t},{})}var te=function(B){K(u,B);function u(t){var e=B.call(this,t)||this;e.subFormDefaultValues=[],e.keys=[],e.toDispose=[],e.id=O(),e.refsMap={},e.makeFormRef=ae(function(s){return function(o){return e.formRef(o,s)}}),e.memoizedFormatValue=ae(function(s,o,r,m,d){return U(ne(d,I({index:m,__index:m},d)),I(I({},r),Array.isArray(o)?ce(d,o):null))},function(s,o,r,m,d){return Array.isArray(o)?JSON.stringify([r,m,d,ce(d,o)]):JSON.stringify(s?[r,m]:[r,m,d])}),e.handleChange=e.handleChange.bind(e),e.handleRadioChange=e.handleRadioChange.bind(e),e.handleSingleFormChange=e.handleSingleFormChange.bind(e),e.handleSingleFormInit=e.handleSingleFormInit.bind(e),e.handleFormInit=e.handleFormInit.bind(e),e.handleAction=e.handleAction.bind(e),e.addItem=e.addItem.bind(e),e.deleteItem=e.deleteItem.bind(e),e.dragTipRef=e.dragTipRef.bind(e),e.flush=e.flush.bind(e),e.handleComboTypeChange=e.handleComboTypeChange.bind(e),e.handleSubFormValid=e.handleSubFormValid.bind(e),e.defaultValue=I({},t.scaffold);var n=t.store;t.value;var i=t.multiple,a=t.formItem,l=t.addHook;return n.config({multiple:i,minLength:e.resolveVariableProps(t,"minLength"),maxLength:e.resolveVariableProps(t,"maxLength"),length:e.getValueAsArray(t).length}),a&&q(a)&&a.setSubStore(n),l&&e.toDispose.push(l(e.flush,"flush")),e}return u.prototype.componentDidUpdate=function(t){var e=this.props;if(he(["minLength","maxLength","value"],t,e)||this.resolveVariableProps(t,"minLength")!==this.resolveVariableProps(e,"minLength")||this.resolveVariableProps(t,"maxLength")!==this.resolveVariableProps(e,"maxLength")){var n=e.store,i=e.multiple,a=this.getValueAsArray(e);n.config({multiple:i,minLength:this.resolveVariableProps(e,"minLength"),maxLength:this.resolveVariableProps(e,"maxLength"),length:a.length}),n.activeKey>=a.length&&n.setActiveKey(Math.max(0,a.length-1)),e.value!==t.value&&!t.formInited&&this.subFormDefaultValues.length&&(this.subFormDefaultValues=this.subFormDefaultValues.map(function(l,s){return I(I({},l),{values:a[s]})}))}},u.prototype.componentWillUnmount=function(){var t,e,n,i,a=this.props.formItem;a&&q(a)&&a.setSubStore(null),this.toDispose.forEach(function(l){return l()}),this.toDispose=[],(e=(t=this.memoizedFormatValue.cache).clear)===null||e===void 0||e.call(t),(i=(n=this.makeFormRef.cache).clear)===null||i===void 0||i.call(n)},u.prototype.resolveVariableProps=function(t,e){var n={minLength:0,maxLength:1/0},i=t[e];if(!i)return n[e];if(typeof i=="string")if(X(i)){var a=P(i,t.data,"| raw");i=typeof a=="number"&&a>=0?a:n[e]}else{var l=parseInt(i,10);i=isNaN(l)?n[e]:l}return i},u.prototype.doAction=function(t,e,n,i){var a,l,s,o,r=t==null?void 0:t.actionType,m=this.props,d=m.onChange,h=m.resetValue,c=m.formStore,p=m.store,b=m.name;if(r==="addItem")this.addItemValue((a=i==null?void 0:i.item)!==null&&a!==void 0?a:{});else if(r==="clear")d("");else if(r==="reset"){var f=(o=W((l=c==null?void 0:c.pristine)!==null&&l!==void 0?l:(s=p==null?void 0:p.parentStore)===null||s===void 0?void 0:s.pristine,b))!==null&&o!==void 0?o:h;d(f??"")}},u.prototype.addItemValue=function(t){var e=this.props,n=e.flat,i=e.joinValues,a=e.addattop,l=e.delimiter,s=e.disabled,o=e.submitOnChange;if(!s){var r=this.getValueAsArray();a===!0?(this.keys.unshift(O()),r.unshift(t)):(r.push(t),this.keys.push(O())),n&&i&&(r=r.join(l||",")),this.props.onChange(r,o,!0)}},u.prototype.getValueAsArray=function(t){t===void 0&&(t=this.props);var e=t.flat,n=t.joinValues,i=t.delimiter;t.type,t.formItem;var a=t.getValue();return n&&e&&typeof a=="string"?a=a.split(i||","):Array.isArray(a)?a=a.concat():a=[],a},u.prototype.addItemWith=function(t){var e,n,i=this.props,a=i.flat,l=i.joinValues,s=i.addattop,o=i.delimiter,r=i.scaffold,m=i.disabled,d=i.submitOnChange;if(!m){var h=this.getValueAsArray();h.push(a?(n=(e=t.scaffold)!==null&&e!==void 0?e:r)!==null&&n!==void 0?n:"":I({},t.scaffold||r)),this.keys.push(O()),a&&l&&(h=h.join(o||",")),s===!0&&(this.keys.unshift(this.keys.pop()),h.unshift(h.pop())),this.props.onChange(h,d,!0)}},u.prototype.addItem=function(){return R(this,void 0,void 0,function(){var t,e,n,i,a,l,s,o,r,m,d,h,c;return E(this,function(p){switch(p.label){case 0:return t=this.props,e=t.flat,n=t.joinValues,i=t.addattop,a=t.delimiter,l=t.scaffold,s=t.disabled,o=t.submitOnChange,r=t.dispatchEvent,m=t.store,s?[2]:(d=this.getValueAsArray(),[4,r("add",J(this.props,{value:e&&n?d.join(a||","):me(d)}))]);case 1:return h=p.sent(),h!=null&&h.prevented?[2]:(d.push(e?l??"":I({},l)),this.keys.push(O()),e&&n&&(d=d.join(a||",")),c=this.keys.length-1,i===!0&&(this.keys.unshift(this.keys.pop()),d.unshift(d.pop()),c=0),m.setActiveKey(c),this.props.onChange(d,o,!0),[2])}})})},u.prototype.deleteItem=function(t){var e,n;return R(this,void 0,void 0,function(){var i,a,l,s,o,r,m,d,h,c,p,b,f,v,A,g,y;return E(this,function(C){switch(C.label){case 0:return i=this.props,a=i.flat,l=i.joinValues,s=i.delimiter,o=i.disabled,r=i.deleteApi,m=i.deleteConfirmText,d=i.data,h=i.env,c=i.translate,p=i.dispatchEvent,b=i.submitOnChange,o?[2]:(f=this.getValueAsArray(),v=U(d,f[t]),[4,p("delete",J(this.props,{key:t,value:a&&l?f.join(s||","):me(f),item:f[t]}))]);case 1:return A=C.sent(),A!=null&&A.prevented?[2]:Ne(r,v)?[4,h.confirm(m?oe(m,v):c("deleteConfirm"))]:[3,4];case 2:return g=C.sent(),g?[4,h.fetcher(r,v)]:[2];case 3:if(y=C.sent(),!y.ok)return!(r!=null&&r.silent)&&h.notify("error",(n=(e=r==null?void 0:r.messages)===null||e===void 0?void 0:e.failed)!==null&&n!==void 0?n:c("deleteFailed")),[2];C.label=4;case 4:return this.keys.splice(t,1),f.splice(t,1),a&&l&&(f=f.join(s||",")),this.props.onChange(f,b,!0),[2]}})})},u.prototype.handleChange=function(t,e,n){var i,a,l,s,o=n.index,r=this.props,m=r.flat,d=r.store,h=r.joinValues,c=r.delimiter,p=r.disabled,b=r.submitOnChange,f=r.type,v=r.syncFields,A=r.name;if(!p){Array.isArray(v)&&v.forEach(function(F){A!=null&&A.startsWith(F)&&(t=I({},t),ie(t,A))});var g=this.getValueAsArray();if(g[o]=m?t.flat:I({},t),m&&h&&(g=g.join(c||",")),f==="input-kv"){var y=!1,C={};try{for(var N=H(g),S=N.next();!S.done;S=N.next()){var x=S.value;C[x.key]?y=!0:C[x.key]=!0}}catch(F){i={error:F}}finally{try{S&&!S.done&&(a=N.return)&&a.call(N)}finally{if(i)throw i.error}}y||this.props.onChange(g,b,!0)}else if(f==="input-kvs"){var y=!1,C={};try{for(var k=H(g),T=k.next();!T.done;T=k.next()){var x=T.value;"_key"in x&&(C[x._key]?y=!0:C[x._key]=!0)}}catch(w){l={error:w}}finally{try{T&&!T.done&&(s=k.return)&&s.call(k)}finally{if(l)throw l.error}}y||this.props.onChange(g,b,!0)}else this.props.onChange(g,b,!0);d.forms.forEach(function(F){return q(F)&&F.items.forEach(function(D){return D.unique&&D.syncOptions(void 0,F.data)})})}},u.prototype.handleRadioChange=function(t,e){var n=e.index,i=e.name,a=e.trueValue,l=a===void 0?!0:a,s=e.falseValue,o=s===void 0?!1:s,r=this.props,m=r.onChange,d=r.submitOnChange,h=r.multiple,c=r.disabled;if(!(!h||c||!i)){var p=this.getValueAsArray();if(!(!Array.isArray(p)||p.length<2||!fe(p[0])))return p=p.map(function(b,f){var v;return I(I({},b),(v={},v[i]=f===n?l:o,v))}),m(p,d,!0),!1}},u.prototype.handleSingleFormChange=function(t){this.props.value===null&&pe(this.defaultValue,t)||this.props.onChange(I({},t),this.props.submitOnChange,!0)},u.prototype.handleSubFormValid=function(t,e){var n=e.index,i=this.props.store;i.setMemberValid(t,n)},u.prototype.handleFormInit=function(t,e){var n,i=e.index,a=this.props,l=a.syncDefaultValue,s=a.flat,o=a.joinValues,r=a.delimiter,m=a.formInited,d=a.onChange,h=a.submitOnChange,c=a.setPrinstineValue,p=a.formItem,b=a.name,f=a.syncFields;if(Array.isArray(f)&&f.forEach(function(g){b!=null&&b.startsWith(g)&&(t=I({},t),ie(t,b))}),p!=null&&p.validated&&((n=this.subForms[i])===null||n===void 0||n.validate(!0,!1,!1)),this.subFormDefaultValues.push({index:i,values:t,setted:!1}),!(l===!1||this.subFormDefaultValues.length!==this.subForms.filter(function(g){return g!==void 0}).length)){var v=this.getValueAsArray(),A=!1;this.subFormDefaultValues=this.subFormDefaultValues.map(function(g){var y=g.index,C=g.values,N=g.setted,S=s?C.flat:I({},C);return!N&&re(v[y],S)&&(v[y]=s?C.flat:I({},C),A=!0),{index:y,values:C,setted:!0}}),A&&(s&&o&&(v=v.join(r||",")),m?d(v,h,!0):c(v))}},u.prototype.handleSingleFormInit=function(t){var e=this.props,n=e.syncDefaultValue,i=e.setPrinstineValue,a=e.value,l=e.nullable;n!==!1&&!l&&re(a,t)&&i(I({},t))},u.prototype.handleAction=function(t,e){var n=this.props.onAction;if(e.actionType==="delete"){e.index!==void 0&&this.deleteItem(e.index);return}n&&n.apply(null,arguments)},u.prototype.validate=function(){var t=this,e=this.props,n=e.messages,i=e.nullable,a=e.value,l=e.translate,s=e.store,o=e.flat,r=this.getValueAsArray(),m=this.resolveVariableProps(this.props,"minLength"),d=this.resolveVariableProps(this.props,"maxLength");if(m&&(!Array.isArray(r)||r.length<m))return l(n&&n.minLengthValidateFailed||"Combo.minLength",{minLength:m});if(d&&Array.isArray(r)&&r.length>d)return l(n&&n.maxLengthValidateFailed||"Combo.maxLength",{maxLength:d});if(i&&!a)return;if(r.length){var h=this.subForms;return Promise.all(r.map(function(c,p){return R(t,void 0,void 0,function(){var b,f,v,A,g,y,C,N,S,x,k,T;return E(this,function(F){switch(F.label){case 0:return b=h[p],b?[2,b.validate(!0,!1,!1)]:[3,1];case 1:if(f=h[Object.keys(h)[0]],!f)return[3,10];v=f.props.store,A=!1,F.label=2;case 2:F.trys.push([2,7,8,9]),g=H(v.items),y=g.next(),F.label=3;case 3:return y.done?[3,6]:(C=y.value,N=xe(C),S=o?c:W(c,C.name,!1),C.extraName&&!o&&(S=[W(c,C.name,!1),W(c,C.extraName,!1)]),N.changeTmpValue(S,"dataChanged"),[4,N.validate(c)]);case 4:if(A=F.sent(),Se(N),A===!1)return[3,6];F.label=5;case 5:return y=g.next(),[3,3];case 6:return[3,9];case 7:return x=F.sent(),k={error:x},[3,9];case 8:try{y&&!y.done&&(T=g.return)&&T.call(g)}finally{if(k)throw k.error}return[7];case 9:return s.setMemberValid(A,p),[2,A];case 10:return[2]}})})})).then(function(c){if(~c.indexOf(!1))return l(n&&n.validateFailed||"validateFailed")})}else if(this.subForms.length)return Promise.all(this.subForms.map(function(c){return c.validate(!0,!1,!1)})).then(function(c){if(~c.indexOf(!1))return l(n&&n.validateFailed||"validateFailed")})},u.prototype.flush=function(){return R(this,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,Promise.all(this.subForms.map(function(e){return e.flush()}))];case 1:return t.sent(),[2]}})})},u.prototype.dragTipRef=function(t){!this.dragTip&&t?this.initDragging():this.dragTip&&!t&&this.destroyDragging(),this.dragTip=t},u.prototype.initDragging=function(){var t=this,e=this.props.classPrefix,n=this.props.submitOnChange,i=be.findDOMNode(this);this.sortable=new ve(i.querySelector(".".concat(e,"Combo-items")),{group:"combo-".concat(this.id),animation:150,handle:".".concat(e,"Combo-itemDrager"),ghostClass:"".concat(e,"Combo-item--dragging"),onEnd:function(a){if(a.newIndex!==a.oldIndex){var l=a.to;a.oldIndex<l.childNodes.length-1?l.insertBefore(a.item,l.childNodes[a.oldIndex>a.newIndex?a.oldIndex+1:a.oldIndex]):l.appendChild(a.item);var s=t.props.value;if(Array.isArray(s)){var o=s.concat();o.splice(a.newIndex,0,o.splice(a.oldIndex,1)[0]),t.keys.splice(a.newIndex,0,t.keys.splice(a.oldIndex,1)[0]),t.props.onChange(o,n,!0),t.props.dispatchEvent("dragEnd",J(t.props,{item:o[a.newIndex],value:o,index:a.newIndex,oldValue:s,oldIndex:a.oldIndex}))}}}})},u.prototype.destroyDragging=function(){this.sortable&&this.sortable.destroy()},Object.defineProperty(u.prototype,"subForms",{get:function(){var t=this;return Object.keys(this.refsMap).map(function(e){return parseInt(e,10)}).sort().map(function(e){return t.refsMap[e]})},enumerable:!1,configurable:!0}),u.prototype.formRef=function(t,e){if(e===void 0&&(e=0),t){for(;t&&t.getWrappedInstance;)t=t.getWrappedInstance();this.refsMap[e]=t}else this.refsMap[e],this.subFormDefaultValues=this.subFormDefaultValues.filter(function(n){var i=n.index;return i!==e}),delete this.refsMap[e]},u.prototype.formatValue=function(t,e){e===void 0&&(e=-1);var n=this.props,i=n.flat,a=n.data,l=n.strictMode,s=n.syncFields;return i&&(t={flat:t}),t=t||this.defaultValue,this.memoizedFormatValue(l!==!1,s,t,e,a)},u.prototype.pickCondition=function(t){var e=this.props.conditions;return le(e,function(n){return n.test&&Y(n.test,t)})},u.prototype.handleComboTypeChange=function(t,e){var n=this.props,i=n.multiple,a=n.onChange,l=n.value;n.flat;var s=n.submitOnChange,o=this.props.conditions,r=le(o,function(d){return d.label===e.label});if(r)if(i){var m=this.getValueAsArray();m.splice(t,1,I({},se(r.scaffold||{},m[t]))),a(m,s,!0)}else a(I({},se(r.scaffold||{},l)),s,!0)},u.prototype.handleTabSelect=function(t){return R(this,void 0,void 0,function(){var e,n,i,a,l,s,o,r,m;return E(this,function(d){switch(d.label){case 0:return e=this.props,n=e.store,i=e.data,a=e.name,l=e.value,s=e.dispatchEvent,o={key:t,item:l[t]},[4,s("tabsChange",U(i,a?I(I({},o),(m={},m[a]=l,m)):o))];case 1:return r=d.sent(),r!=null&&r.prevented?[2]:(n.setActiveKey(t),[2])}})})},u.prototype.setNull=function(t){t.preventDefault();var e=this.props.onChange;e(null),this.subForms.forEach(function(n){n.clearErrors()})},u.prototype.renderPlaceholder=function(){var t=this.props,e=t.placeholder,n=t.translate;return V("span",{className:"text-muted",children:n(e||"placeholder.noData")})},u.prototype.renderTabsMode=function(){var t=this,e=this.props;e.classPrefix;var n=e.classnames,i=e.tabsStyle;e.formClassName,e.render;var a=e.disabled,l=e.store,s=e.flat;e.subFormMode,e.addButtonText;var o=e.addable,r=e.removable,m=e.typeSwitchable,d=e.itemRemovableOn,h=e.delimiter;e.canAccessSuperData,e.addIcon;var c=e.deleteIcon,p=e.tabsLabelTpl,b=e.conditions;e.changeImmediately;var f=e.addBtnText;e.static;var v=e.translate,A=e.testIdBuilder,g=this.props.items,y=this.props.value;s&&typeof y=="string"&&(y=y.split(h||","));var C=l.removable!==!1&&!a&&r!==!1;return Array.isArray(y)||(y=[]),V(ge,{addBtnText:v(f||"add"),className:"ComboTabs",mode:i,activeKey:l.activeKey,onSelect:this.handleTabSelect,testIdBuilder:A,additionBtns:!a&&o!==!1&&l.addable?V("li",{className:n("Tabs-link ComboTabs-addLink"),children:this.renderAddBtn()}):null,children:y.map(function(N,S){var x=t.formatValue(N,S),k=A==null?void 0:A.getChild("tab-".concat(S)),T=null,F=void 0;C&&(!d||Y(d,N)!==!1)&&(F=V("div",{...I({onClick:t.deleteItem.bind(t,S),key:"delete",className:n("Combo-tab-delBtn ".concat(l.removable?"":"is-disabled")),"data-tooltip":v("delete"),"data-position":"bottom"},k==null?void 0:k.getChild("delBtn").getTestId()),children:c?V("i",{className:c}):V(M,{icon:"status-close",className:"icon"})})),Array.isArray(b)&&b.length&&(T=t.pickCondition(x),g=T?T.items:void 0);var D=s&&g?[I(I({},g&&g[0]),{name:"flat"})]:g,w=Array.isArray(D)&&D.some(function(_){return _.unique});return t.keys[S]||t.keys.splice(S,0,O()),L(ye,{title:oe(p||v("{{index}}",{index:x.index+1}),x),toolbar:F,eventKey:S,mountOnEnter:!w,unmountOnExit:!1,className:l.memberValidMap[S]===!1?"has-error":"",tabClassName:l.memberValidMap[S]===!1?"has-error":"",testIdBuilder:k,children:[T&&m!==!1?L("div",{className:n("Combo-itemTag"),children:[V("label",{children:v("Combo.type")}),V($,{onChange:t.handleComboTypeChange.bind(t,S),options:b.map(function(_){return{label:_.label,value:_.label}}),value:T.label,clearable:!1})]}):null,V("div",{className:n("Combo-itemInner"),children:D?t.renderItems(D,x,S,N):V(G,{level:"warning",className:"m-b-none",children:v("Combo.invalidData")})})]},t.keys[S])})})},u.prototype.renderDelBtn=function(t,e){var n=this;if(this.props.static)return null;var i=this.props;i.classPrefix;var a=i.classnames,l=i.render,s=i.store,o=i.deleteIcon,r=i.translate,m=i.itemRemovableOn,d=i.disabled,h=i.removable,c=i.deleteBtn,p=i.mobileUI,b=i.data,f=i.testIdBuilder,v=f==null?void 0:f.getChild("delete-btn-".concat(e)),A=s.removable!==!1&&!d&&h!==!1;return A&&(!m||Y(m,t)!==!1)?Q(c)?l("delete-btn",I(I({},c),{type:"button",className:a("Combo-delController",c?c.className:""),testIdBuilder:v,onClick:function(g){if(!c.onClick){n.deleteItem(e);return}var y=c.onClick;typeof y=="string"&&(y=Ce(c.onClick,"e","index","props"));var C=y(g,e,n.props);C&&C.then?C.then(function(){n.deleteItem(e)}):n.deleteItem(e)}}),{data:ne(b,{index:e})}):typeof c=="string"?l("delete-btn",{type:"button",className:a("Combo-delController"),label:c,onClick:this.deleteItem.bind(this,e),testIdBuilder:v}):V("a",{...I({onClick:this.deleteItem.bind(this,e),key:"delete",className:a("Combo-delBtn ".concat(s.removable?"":"is-disabled")),"data-tooltip":p?null:r("delete"),"data-position":"bottom"},v==null?void 0:v.getTestId()),children:o?V("i",{className:o}):V(M,{icon:"status-close",className:"icon"})}):null},u.prototype.renderAddBtn=function(){var t=this;if(this.props.static)return null;var e=this.props;e.classPrefix;var n=e.classnames,i=e.render,a=e.addButtonClassName,l=e.store,s=e.addButtonText,o=e.addBtn,r=e.addable,m=e.addIcon,d=e.conditions,h=e.translate,c=e.tabsMode,p=e.testIdBuilder,b=Array.isArray(d)&&d.length,f=p==null?void 0:p.getChild("add-button");return V(de,{children:l.addable&&r!==!1&&(b?i("add-button",{type:"dropdown-button",icon:m?V(M,{icon:"plus-fine",className:"icon"}):"",label:h(s||"add"),level:"info",size:"sm",closeOnClick:!0,btnClassName:a,testIdBuilder:f},{buttons:d==null?void 0:d.map(function(v){return{label:v.label,onClick:function(A){return t.addItemWith(v),!1}}})}):c?L("a",{onClick:this.addItem,children:[m?V(M,{icon:"plus-fine",className:"icon"}):null,V("span",{children:h(s||"add")})]}):Q(o)?i("add-button",I(I({},o),{type:"button",testIdBuilder:f,onClick:function(){return t.addItem()}})):L(Ie,{className:n("Combo-addBtn",a),onClick:this.addItem,testIdBuilder:f,children:[m?V(M,{icon:"plus-fine",className:"icon"}):null,V("span",{children:h(s||"add")})]}))})},u.prototype.renderMultipe=function(){var t=this;if(this.props.tabsMode)return this.renderTabsMode();var e=this.props;e.classPrefix;var n=e.classnames,i=e.multiLine,a=e.disabled,l=e.flat,s=e.draggable,o=e.draggableTip,r=e.typeSwitchable,m=e.delimiter,d=e.dragIcon,h=e.noBorder,c=e.conditions,p=e.placeholder,b=e.translate,f=e.itemClassName,v=e.itemsWrapperClassName,A=e.static,g=e.mobileUI,y=e.store,C=this.props.items,N=this.props.value;return l&&typeof N=="string"&&(N=N.split(m||",")),L("div",{className:n("Combo Combo--multi",{"is-mobile":g},i?"Combo--ver":"Combo--hor",h?"Combo--noBorder":"",a?"is-disabled":"",!A&&!a&&s&&Array.isArray(N)&&N.length>1?"is-draggable":""),children:[V("div",{className:n("Combo-items",v),children:Array.isArray(N)&&N.length?N.map(function(S,x,k){var T=t.renderDelBtn(S,x),F=t.formatValue(S,x),D=null;Array.isArray(c)&&c.length&&(D=t.pickCondition(F),C=D?D.items:void 0);var w=l&&C?[I(I({},C&&C[0]),{name:"flat"})]:C;return t.keys[x]||t.keys.splice(x,1,O()),L("div",{className:n("Combo-item",f,y.memberValidMap[x]===!1?"has-error":""),children:[!A&&!a&&s&&k.length>1?V("div",{className:n("Combo-itemDrager"),children:V("a",{"data-tooltip":b("Combo.dragDropSort"),"data-position":"bottom",children:d?V("i",{className:d}):V(M,{icon:"drag-bar",className:"icon"})},"drag")}):null,D&&r!==!1?L("div",{className:n("Combo-itemTag"),children:[V("label",{children:b("Combo.type")}),V($,{onChange:t.handleComboTypeChange.bind(t,x),options:c.map(function(_){return{label:_.label,value:_.label}}),value:D.label,clearable:!1})]}):null,V("div",{className:n("Combo-itemInner"),children:w?t.renderItems(w,F,x,S):V(G,{level:"warning",className:"m-b-none",children:b("Combo.invalidData")})}),T]},t.keys[x])}):p?V("div",{className:n("Combo-placeholder"),children:b(p)}):null}),!A&&!a?L("div",{className:n("Combo-toolbar"),children:[this.renderAddBtn(),s?V("span",{className:n("Combo-dragableTip"),ref:this.dragTipRef,children:Array.isArray(N)&&N.length>1?b(o):""}):null]}):null]})},u.prototype.renderSingle=function(){var t=this.props,e=t.conditions,n=t.classnames,i=t.value,a=t.multiLine,l=t.noBorder,s=t.disabled,o=t.typeSwitchable,r=t.nullable,m=t.translate,d=t.itemClassName,h=t.mobileUI,c=t.store,p=this.props.items,b=Q(i)?this.formatValue(i):this.formatValue(this.defaultValue),f=null;return Array.isArray(e)&&e.length&&(f=this.pickCondition(b),p=f?f.items:void 0),L("div",{className:n("Combo Combo--single",{"is-mobile":h},a?"Combo--ver":"Combo--hor",l?"Combo--noBorder":"",s?"is-disabled":""),children:[L("div",{className:n("Combo-item",d,c.memberValidMap[0]===!1?"has-error":""),children:[f&&o!==!1?L("div",{className:n("Combo-itemTag"),children:[V("label",{children:m("Combo.type")}),V($,{onChange:this.handleComboTypeChange.bind(this,0),options:e.map(function(v){return{label:v.label,value:v.label}}),value:f.label,clearable:!1})]}):null,V("div",{className:n("Combo-itemInner"),children:p?this.renderItems(p,b):V(G,{level:"warning",className:"m-b-none",children:m("Combo.invalidData")})})]}),i&&r?V("a",{className:n("Combo-setNullBtn"),href:"#",onClick:this.setNull,children:m("clear")}):null]})},u.prototype.renderItems=function(t,e,n,i){var a=this.props,l=a.classnames,s=a.formClassName,o=a.render,r=a.multiLine,m=a.disabled,d=a.canAccessSuperData,h=a.multiple,c=a.tabsMode,p=a.subFormMode,b=a.subFormHorizontal,f=a.changeImmediately,v=a.lazyLoad;a.translate;var A=a.static,g=a.testIdBuilder,y=a.updatePristineAfterStoreDataReInit,C=Array.isArray(t)?t.map(function(N,S){var x=n!==void 0&&n>=0?"-".concat(n):"",k="item-".concat(N.testid||N.id||S)+x;return I(I({},N),{testIdBuilder:g==null?void 0:g.getChild(k)})}):t;if(h){if(h&&n!==void 0&&n>=0)return o("multiple/".concat(n),{type:"form",body:C,wrapperComponent:"div",wrapWithPanel:!1,mode:c||r?p:"row",horizontal:b,className:l("Combo-form",s)},I(I({index:n,disabled:m,static:A,data:e,originData:i,onChange:this.handleChange,onInit:this.handleFormInit,onAction:this.handleAction,onRadioChange:this.handleRadioChange,ref:this.makeFormRef(n),onValidChange:this.handleSubFormValid,canAccessSuperData:d,lazyChange:!f,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0},c?{}:{lazyLoad:v}),{updatePristineAfterStoreDataReInit:y??!1}))}else return o("single",{type:"form",body:C,wrapperComponent:"div",wrapWithPanel:!1,mode:r?p||"normal":"row",horizontal:b,className:l("Combo-form",s)},{index:0,disabled:m,static:A,data:e,originData:i,onChange:this.handleSingleFormChange,ref:this.makeFormRef(0),onValidChange:this.handleSubFormValid,onInit:this.handleSingleFormInit,canAccessSuperData:d,lazyChange:!f,formLazyChange:!1,value:void 0,formItemValue:void 0,formStore:void 0,updatePristineAfterStoreDataReInit:y??!1});return V(de,{})},u.prototype.renderStatic=function(t){return this.props.render("static-input-kv",{type:"json"},this.props)},u.prototype.render=function(){var t=this.props,e=t.type,n=t.formInited,i=t.multiple,a=t.className;t.style,t.classPrefix;var l=t.classnames,s=t.static,o=t.staticSchema;return s&&(o||["input-kv","input-kvs"].includes(e))?this.renderStatic():n||typeof n>"u"?V("div",{className:l("ComboControl",a),children:i?this.renderMultipe():this.renderSingle()}):null},u.defaultProps={minLength:0,maxLength:1/0,multiple:!1,multiLine:!1,addButtonClassName:"",formClassName:"",subFormMode:"normal",draggableTip:"",addButtonText:"add",canAccessSuperData:!1,addIcon:!0,dragIcon:"",deleteIcon:"",tabsMode:!1,tabsStyle:"",placeholder:"placeholder.empty",itemClassName:"",itemsWrapperClassName:""},u.propsList=["minLength","maxLength","multiple","multiLine","addButtonClassName","subFormMode","draggableTip","addButtonText","draggable","scaffold","canAccessSuperData","addIcon","dragIcon","deleteIcon","noBorder","conditions","tabsMode","tabsStyle","lazyLoad","changeImmediately","strictMode","items","conditions","messages","formStore","itemClassName","itemsWrapperClassName"],z([ue,j("design:type",Function),j("design:paramtypes",[Number]),j("design:returntype",Promise)],u.prototype,"handleTabSelect",null),z([ue,j("design:type",Function),j("design:paramtypes",[Object]),j("design:returntype",void 0)],u.prototype,"setNull",null),u}(Ve.Component),De=function(B){K(u,B);function u(){return B!==null&&B.apply(this,arguments)||this}return u.prototype.setData=function(t,e,n,i){return R(this,void 0,void 0,function(){var a,l,s,o,r,m,d,h,c,p;return E(this,function(b){switch(b.label){case 0:return a=this.props,l=a.multiple,s=a.onChange,o=a.submitOnChange,l?(r=ke([],Be(this.getValueAsArray()),!1),m=r.length,n===void 0?[3,1]:(d=String(n).split(","),d.forEach(function(f){var v=Number(f);r.splice(v,1,I(I({},r[v]),t))}),s==null||s(r,o,!0),[3,7])):[3,8];case 1:if(i===void 0)return[3,6];h=0,b.label=2;case 2:return h<m?(c=r[h],[4,Fe(i,c)]):[3,5];case 3:p=b.sent(),p&&r.splice(h,1,I(I({},r[h]),t)),b.label=4;case 4:return h++,[3,2];case 5:return s==null||s(r,o,!0),[3,7];case 6:s==null||s(t,o,!0),b.label=7;case 7:return[3,9];case 8:s==null||s(t,o,!0),b.label=9;case 9:return[2]}})})},u=z([Z({type:"combo",storeType:ee.name,extendsData:!1,shouldComponentUpdate:function(t,e){return X(t.maxLength)&&P(e.maxLength,e.data)!==P(t.maxLength,t.data)||X(t.minLength)&&P(e.minLength,e.data)!==P(t.minLength,t.data)}})],u),u}(te),Le=function(B){K(u,B);function u(){return B!==null&&B.apply(this,arguments)||this}return u=z([Z({type:"input-kv",storeType:ee.name,extendsData:!1})],u),u}(te),_e=function(B){K(u,B);function u(){return B!==null&&B.apply(this,arguments)||this}return u=z([Z({type:"input-kvs",storeType:ee.name,extendsData:!1})],u),u}(te);export{De as ComboControlRenderer,Le as KVControlRenderer,_e as KVSControlRenderer,te as default};

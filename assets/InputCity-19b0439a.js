import{a as I,d as b,l as T,j as m,ao as D,S as V,e as C,p as _,q as o,R as E,bv as k,bw as A,aq as M,h as U,k as z,F,bx as L,a_ as $,C as q,_ as Y,Y as G}from"./index-26b02238.js";var N=function(u){var t,e=u.value,i=u.db,n=u.delimiter,s=n===void 0?",":n,a={code:0,province:"",provinceCode:0,city:"",cityCode:0,district:"",districtCode:0,street:""};if(!i||!e)return a;var r=e&&e.code||typeof e=="number"&&e||typeof e=="string"&&/(\d{6})/.test(e)&&RegExp.$1;if(r&&i[r]){r=parseInt(r,10),a.code=r;var l=r-r%1e4;i[l]&&(a.provinceCode=l,a.province=i[l]);var d=r-r%100;d!==l&&i[d]?(a.cityCode=d,a.city=i[d]):~((t=i.city[l])===null||t===void 0?void 0:t.indexOf(r))&&(a.cityCode=r,a.city=i[r]),r%100&&(a.district=i[r],a.districtCode=r)}return e&&e.street?a.street=e.street:typeof e=="string"&&~e.indexOf(s)&&(a.street=e.slice(e.indexOf(s)+s.length)),a},P=function(u){Y(()=>import("./CityDB-c10a7a1f.js"),[],import.meta.url).then(u)},H=function(u){I(t,u);function t(){var e=u!==null&&u.apply(this,arguments)||this;return e.state={code:0,province:"",provinceCode:0,city:"",cityCode:0,district:"",districtCode:0,street:""},e}return t.prototype.componentDidMount=function(){var e=this;this.loadDb(function(){return e.syncIn()})},t.prototype.componentDidUpdate=function(e){var i=this,n=this.props;n.value!==e.value&&this.loadDb(function(){return i.syncIn(n)})},t.prototype.loadDb=function(e){var i=this;if(this.state.db){e==null||e();return}P(function(n){i.setState({db:b(b({},n.default),{province:n.province,city:n.city,district:n.district})},e)})},t.prototype.handleProvinceChange=function(e){this.setState(e?{province:e.label,provinceCode:e.value,city:"",cityCode:0,district:"",districtCode:0,street:"",code:e?e.value:0}:{code:0,province:"",provinceCode:0,city:"",cityCode:0,district:"",districtCode:0,street:""},this.syncOut)},t.prototype.handleCityChange=function(e){if(e.value%100)return this.handleDistrictChange(e,{cityCode:e.value});this.setState(e?{city:e.label,cityCode:e.value,district:"",districtCode:0,street:"",code:e.value}:{city:"",cityCode:0,district:"",districtCode:0,street:"",code:this.state.provinceCode},this.syncOut)},t.prototype.handleDistrictChange=function(e,i){i===void 0&&(i={}),this.setState(e?b(b({},i),{district:e.label,districtCode:e.value,street:"",code:e.value}):b(b({},i),{district:"",districtCode:0,street:"",code:this.state.cityCode}),this.syncOut)},t.prototype.handleStreetChange=function(e){this.setState({street:e.currentTarget.value})},t.prototype.handleStreetEnd=function(){this.syncOut()},t.prototype.syncIn=function(e){e===void 0&&(e=this.props);var i=this.state.db,n=e.value,s=e.delimiter;i&&this.setState(N({value:n,delimiter:s,db:i}))},t.prototype.syncOut=function(){var e=this.props,i=e.onChange,n=e.allowStreet,s=e.joinValues,a=e.extractValue,r=e.delimiter,l=this.state,d=l.code,h=l.province,c=l.city,g=l.district,p=l.street,y=l.provinceCode,O=l.cityCode,v=l.districtCode;i((typeof a>"u"?s:a)?d?n&&p?[d,p].join(r):String(d):"":{code:d,provinceCode:y,province:h,cityCode:O,city:c,districtCode:v,district:g,street:p})},t.prototype.render=function(){var e,i,n=this.props,s=n.classnames,a=n.className;n.style;var r=n.disabled,l=n.allowCity,d=n.allowDistrict,h=n.allowStreet,c=n.searchable,g=n.translate,p=n.loadingConfig,y=n.popOverContainer,O=n.itemClassName,v=n.testIdBuilder,j=this.state,S=j.provinceCode,x=j.cityCode,B=j.districtCode,R=j.street,f=j.db;return f?T("div",{className:s("CityPicker",a),children:[m(D,{className:s(O),searchable:c,disabled:r,options:f.province.map(function(w){return{label:f[w],value:w}}),value:S||"",onChange:this.handleProvinceChange,popOverContainer:y,testIdBuilder:v==null?void 0:v.getChild("province")}),l&&f.city[S]&&f.city[S].length?m(D,{className:s(O),searchable:c,disabled:r,options:f.city[S].map(function(w){return{label:f[w],value:w}}),value:x||"",onChange:this.handleCityChange,popOverContainer:y,testIdBuilder:v==null?void 0:v.getChild("city")}):null,x&&d&&(!((i=(e=f.district[S])===null||e===void 0?void 0:e[x])===null||i===void 0)&&i.length)?m(D,{className:s(O),searchable:c,disabled:r,options:f.district[S][x].map(function(w){return{label:f[w],value:w}}),value:B||"",onChange:this.handleDistrictChange,popOverContainer:y,testIdBuilder:v==null?void 0:v.getChild("district")}):null,h&&S?m("input",{...b({className:s("CityPicker-input"),value:R||"",onChange:this.handleStreetChange,onBlur:this.handleStreetEnd,placeholder:g("City.street"),disabled:r},v==null?void 0:v.getChild("street").getTestId())}):null]}):m(V,{show:!0,size:"sm",loadingConfig:p})},t.defaultProps={joinValues:!0,extractValue:!0,delimiter:",",allowCity:!0,allowDistrict:!0,allowStreet:!1},C([_,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],t.prototype,"handleProvinceChange",null),C([_,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],t.prototype,"handleCityChange",null),C([_,o("design:type",Function),o("design:paramtypes",[Object,Object]),o("design:returntype",void 0)],t.prototype,"handleDistrictChange",null),C([_,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],t.prototype,"handleStreetChange",null),C([_,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],t.prototype,"handleStreetEnd",null),C([_,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",void 0)],t.prototype,"syncIn",null),C([_,o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],t.prototype,"syncOut",null),t}(E.Component),J=k(A(H)),K=function(u){I(t,u);function t(){var e=u!==null&&u.apply(this,arguments)||this;return e.state={db:null},e}return t.prototype.doAction=function(e,i,n){var s,a,r=this.props,l=r.resetValue,d=r.onChange,h=r.formStore,c=r.store,g=r.name,p=e==null?void 0:e.actionType;if(p==="clear")d("");else if(p==="reset"){var y=(a=M((s=h==null?void 0:h.pristine)!==null&&s!==void 0?s:c==null?void 0:c.pristine,g))!==null&&a!==void 0?a:l;d(y??"")}},t.prototype.handleChange=function(e){return U(this,void 0,void 0,function(){var i,n,s,a;return z(this,function(r){switch(r.label){case 0:return i=this.props,n=i.dispatchEvent,s=i.onChange,[4,n("change",G(this.props,{value:e},"value"))];case 1:return a=r.sent(),a!=null&&a.prevented?[2]:(s(e),[2])}})})},t.prototype.renderStatic=function(e){var i=this;e===void 0&&(e="");var n=this.props,s=n.value,a=n.delimiter,r=n.loadingConfig;if(!this.state.db)return P(function(p){i.setState({db:b(b({},p.default),{province:p.province,city:p.city,district:p.district})})}),m(V,{size:"sm",show:!0,loadingConfig:r});if(!s)return m(F,{children:e});var l=N({value:s,delimiter:a,db:this.state.db}),d=l.province,h=l.city,c=l.district,g=l.street;return m(F,{children:[d,h,c,g].filter(function(p){return!!p}).join(a)})},t.prototype.render=function(){var e=this.props,i=e.value,n=e.allowCity,s=e.allowDistrict,a=e.extractValue,r=e.joinValues,l=e.allowStreet,d=e.disabled,h=e.searchable,c=e.env,g=e.mobileUI,p=e.popOverContainer,y=e.itemClassName,O=e.testIdBuilder;return g?m(L,{value:i,popOverContainer:c==null?void 0:c.getModalContainer,onChange:this.handleChange,allowCity:n,allowDistrict:s,extractValue:a,joinValues:r,allowStreet:l,disabled:d,mobileUI:g}):m(J,{itemClassName:y,popOverContainer:p||(c==null?void 0:c.getModalContainer),searchable:h,value:i,onChange:this.handleChange,allowCity:n,allowDistrict:s,extractValue:a,joinValues:r,allowStreet:l,disabled:d,testIdBuilder:O})},C([_,o("design:type",Function),o("design:paramtypes",[Object,Object,Boolean]),o("design:returntype",void 0)],t.prototype,"doAction",null),C([_,o("design:type",Function),o("design:paramtypes",[Object]),o("design:returntype",Promise)],t.prototype,"handleChange",null),C([$(),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],t.prototype,"render",null),t}(E.Component),W=function(u){I(t,u);function t(){return u!==null&&u.apply(this,arguments)||this}return t=C([q({type:"input-city",sizeMutable:!1})],t),t}(K);export{W as CheckboxControlRenderer,H as CityPicker,K as LocationControl,J as default};

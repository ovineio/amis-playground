import{a as K,bj as M,bk as F,aq as ut,bl as pt,bm as lt,h as $,k as X,n as dt,l as ct,X as B,j as P,U as Y,d as O,ao as ht,V as G,b8 as ft,e as w,p as q,q as c,a_ as mt,R as vt,C as gt,Y as H,bn as yt}from"./index-26b02238.js";var J=function(x){K(a,x);function a(e){var n=x.call(this,e)||this;n.handleChange=n.handleChange.bind(n),n.handleChangeUnit=n.handleChangeUnit.bind(n);var t=n.getUnit(),s=M(e.unitOptions),u=e.formItem,i=e.value;return u&&n.formatNumber(i,!0),n.state={unit:t,unitOptions:s},n}return a.prototype.doAction=function(e,n,t,s){var u,i,o=e==null?void 0:e.actionType,r=this.props,p=r.min,b=r.max,S=r.precision,C=r.step,v=r.resetValue,_=r.big,g=r.onChange,h=r.clearValueOnEmpty,f=r.formStore,N=r.store,m=r.name;if(o==="clear")g==null||g(h?void 0:"");else if(o==="reset"){var U=F.normalizePrecision(this.filterNum(S),this.filterNum(C)),y=(i=ut((u=f==null?void 0:f.pristine)!==null&&u!==void 0?u:N==null?void 0:N.pristine,m))!==null&&i!==void 0?i:v,d=F.normalizeValue(y??"",this.filterNum(p,_),this.filterNum(b,_),U,y??"",h,_);g==null||g(h&&d===""?void 0:d)}},a.prototype.formatNumber=function(e,n){n===void 0&&(n=!1);var t=this.props,s=t.showAsPercent,u=t.suffix,i=t.step,o=t.big,r=t.setPrinstineValue,p=this.props.precision;s&&u==="%"&&(p=(p||0)+2);var b=this.getUnit(),S=M(this.props.unitOptions),C=F.normalizePrecision(this.filterNum(p),this.filterNum(i));if(e!=null&&C!=null&&(!b||S.length===0)&&o!==!0){var v=parseFloat(pt(e.toString(),".",C));!isNaN(v)&&v!==e&&(e=v,n&&r(v))}return e},a.prototype.getUnit=function(){var e,n,t=this.props;if(t.unitOptions&&t.unitOptions.length){var s=M(t.unitOptions).map(function(p){return p.value});if(t.value&&typeof t.value=="string"){var u=s[0];s.sort(function(p,b){return b.length-p.length});try{for(var i=lt(s),o=i.next();!o.done;o=i.next()){var r=o.value;if(t.value.endsWith(r)){u=r;break}}}catch(p){e={error:p}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return u}else return s[0]}},a.prototype.getValue=function(e){var n=this.props,t=n.resetValue,s=n.unitOptions;if(!(e&&typeof e!="number"&&typeof e!="string"))return e!==null&&s&&this.state.unit&&(e=e+String(this.state.unit)),e===null?t??null:e},a.prototype.dispatchEvent=function(e){return $(this,void 0,void 0,function(){var n,t,s;return X(this,function(u){return n=this.props,t=n.dispatchEvent,s=n.value,t(e,H(this.props,{value:s})),[2]})})},a.prototype.handleChange=function(e){return $(this,void 0,void 0,function(){var n,t,s,u,i,o,r;return X(this,function(p){switch(p.label){case 0:return n=this.props,t=n.onChange,s=n.dispatchEvent,u=n.clearValueOnEmpty,i=this.getValue(e),o=u&&i===""?void 0:i,o=this.formatNumber(o),[4,s("change",H(this.props,{value:o}))];case 1:return r=p.sent(),r!=null&&r.prevented?[2]:(t(o),[2])}})})},a.prototype.changeCursorPos=function(e){var n,t;if(!isNaN(e)){var s=this.props,u=s.kilobitSeparator,i=s.prefix,o=e>0?Math.floor(e):Math.ceil(e),r="".concat(e).length;if(i&&(r+=i.length),u){var p=Math.floor(("".concat(Math.abs(o)).length-1)/3);p>0&&(r+=p)}this.input&&(u||i)&&((t=(n=this.input).setSelectionRange)===null||t===void 0||t.call(n,r,r))}},a.prototype.filterNum=function(e,n){if(n===void 0&&(n=!1),!(typeof e>"u"))return typeof e!="number"&&(e=dt(e,this.props.data),e=/^[-]?\d+/.test(e)?n?e:+e:void 0),e},a.prototype.handleChangeUnit=function(e){var n=this,t=this.props.value,s=this.state.unit;this.setState({unit:e.value},function(){t&&(t=t.toString().replace(s,""),n.props.onChange(t+n.state.unit))})},a.prototype.componentDidUpdate=function(e){var n=this.getUnit(),t=this.props,s=t.value,u=t.formInited,i=t.onChange,o=t.setPrinstineValue;if(s!=null&&(typeof s=="string"||typeof s=="number")&&n&&!String(s).endsWith(n)){var r=this.getValue(s);u===!1?o==null||o(r):i==null||i(r)}var p=/^([-+]?(([1-9]\d*\.?\d*)|(0\.\d*[1-9]))[^\d\.]*)$/;this.props.value!==e.value&&p.test(this.props.value)&&this.setState({unit:n}),this.props.unitOptions!==e.unitOptions&&this.setState({unitOptions:M(this.props.unitOptions)})},a.prototype.inputRef=function(e){this.input=e},a.prototype.focus=function(){this.input&&this.input.focus()},a.prototype.render=function(){var e,n=this,t=this.props,s=t.className,u=t.style,i=t.classPrefix,o=t.value,r=t.step,p=t.precision,b=t.max,S=t.min,C=t.disabled,v=t.placeholder,_=t.showSteps,g=t.borderMode,h=t.suffix,f=t.prefix,N=t.kilobitSeparator,m=t.unitOptions,U=t.readOnly,y=t.keyboard,d=t.displayMode,R=t.big,Q=t.resetValue,Z=t.clearValueOnEmpty,k=t.css,I=t.themeCss,L=t.inputControlClassName,E=t.id,z=t.env,tt=t.name,et=t.showAsPercent,nt=t.testIdBuilder,it=t.popOverContainer,A=this.state.unit,D=this.filterNum(p),rt=N||f||h?function(l,V){var j,W=V.userTyping,at=V.input;if(N&&l)if(W||n.input===document.activeElement){var T=l.toString().split(".");T[0]=T[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),l=T.join(".")}else l=yt(l,D);return h&&W&&((j=n.input)===null||j===void 0?void 0:j.selectionStart)===at.length?"".concat(f||"").concat(l):"".concat(f||"").concat(l).concat(h||"")}:void 0,st=function(l){return l&&(f&&(l=l.replace(f,"")),h&&(l=l.replace(h,"")),N&&(l=l.replace(/,/g,""))),l},ot=A&&o&&typeof o=="string"?o.replace(A,""):isNaN(o)?void 0:o;return ct("div",{className:B("".concat(i,"NumberControl"),(e={},e["".concat(i,"NumberControl--withUnit")]=m,e),s),style:u,children:[P(F,{name:tt,inputControlClassName:B(L,Y(O(O({},this.props),{name:"inputControlClassName",id:E,themeCss:I||k})),Y(O(O({},this.props),{name:"inputControlClassName",id:E,themeCss:I||k,extra:"inner"}))),inputRef:this.inputRef,value:ot,resetValue:Q,step:r,max:this.filterNum(b,R),min:this.filterNum(S,R),formatter:rt,parser:st,onChange:this.handleChange,disabled:C,placeholder:v,precision:D,showSteps:_,borderMode:g,readOnly:U,suffix:h,showAsPercent:et,onFocus:function(){return n.dispatchEvent("focus")},onBlur:function(){return n.dispatchEvent("blur")},keyboard:y,displayMode:d,big:R,clearValueOnEmpty:Z,testIdBuilder:nt}),Array.isArray(m)&&m.length!==0?m.length>1?P(ht,{value:A,clearable:!1,options:this.state.unitOptions||[],onChange:this.handleChangeUnit,className:"".concat(i,"NumberControl-unit"),disabled:C,popOverContainer:it}):P("div",{className:B("".concat(i,"NumberControl-unit"),"".concat(i,"NumberControl-single-unit"),"".concat(i,"Select"),"".concat(U?"".concat(i,"NumberControl-readonly"):"")),children:typeof m[0]=="string"?m[0]:m[0].label}):null,P(G,{...O({},this.props,{config:{themeCss:I||k,classNames:[{key:"inputControlClassName",weights:{focused:{pre:"".concat(i,"Number-").concat(d?d+"-":"","focused.")},disabled:{pre:"".concat(i,"Number-").concat(d?d+"-":"","disabled.")}}}],id:E},env:z})}),P(G,{...O({},this.props,{config:{themeCss:ft(I||k),classNames:[{key:"inputControlClassName",weights:{default:{inner:"input"},hover:{inner:"input"},focused:{pre:"".concat(i,"Number-").concat(d?d+"-":"","focused."),inner:"input"},disabled:{pre:"".concat(i,"Number-").concat(d?d+"-":"","disabled."),inner:"input"}}}],id:E&&E+"-inner"},env:z})})]})},a.defaultProps={step:1,resetValue:"",clearValueOnEmpty:!1},w([q,c("design:type",Function),c("design:paramtypes",[String]),c("design:returntype",Promise)],a.prototype,"dispatchEvent",null),w([q,c("design:type",Function),c("design:paramtypes",[Number]),c("design:returntype",void 0)],a.prototype,"changeCursorPos",null),w([q,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",void 0)],a.prototype,"inputRef",null),w([mt(),c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",void 0)],a.prototype,"render",null),a}(vt.Component),Ct=function(x){K(a,x);function a(){return x!==null&&x.apply(this,arguments)||this}return a.defaultProps=O({validations:"isNumeric"},J.defaultProps),a=w([gt({type:"input-number",detectProps:["unitOptions","precision","suffix"]})],a),a}(J);export{Ct as NumberControlRenderer,J as default};

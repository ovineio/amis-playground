import{cj as ne,g as re,ck as ae,cl as le,cm as ie,a as W,R as H,aq as oe,h as A,k as I,bJ as Q,cn as M,bX as q,j as C,a6 as X,bf as de,co as ce,F as ue,l as D,aN as Y,d as j,I as he,cp as K,N as pe,P as ve,Q as fe,U as G,bg as ye,aK as ge,S as me,bh as Ce,cq as be,V as ke,e as k,p as F,q as l,a_ as Oe,b9 as te,Y as Ne,cr as Se,cs as U,ct as Fe,b4 as Z,bc as Pe}from"./index-26b02238.js";var _e=ae,Te=ne,we=le,Re=ie,Ve=Te(function(T){return we(_e(T,1,Re,!0))}),xe=Ve;const ee=re(xe);var se=function(T){W(a,T);function a(){var e=T!==null&&T.apply(this,arguments)||this;return e.outTarget=H.createRef(),e.state={isOpened:!1,isFocused:!1,inputValue:"",stack:[e.props.options]},e}return a.prototype.domRef=function(e){this.target=e},a.prototype.componentDidUpdate=function(e){e.options!==this.props.options&&this.setState({stack:[this.props.options]})},a.prototype.doAction=function(e,t,n){var r,s,i=this.props,o=i.resetValue,d=i.onChange,c=i.formStore,h=i.store,u=i.name,f=e==null?void 0:e.actionType;if(f==="clear")d==null||d("");else if(f==="reset"){var m=(s=oe((r=c==null?void 0:c.pristine)!==null&&r!==void 0?r:h==null?void 0:h.pristine,u))!==null&&s!==void 0?s:o;d==null||d(m??"")}},a.prototype.dispatchEvent=function(e,t){return t===void 0&&(t={}),A(this,void 0,void 0,function(){var n,r,s,i,o,d,c;return I(this,function(h){switch(h.label){case 0:return n=this.props,r=n.dispatchEvent,s=n.options,i=n.multiple,o=n.value,d=n.selectedOptions,[4,r(e,Ne(this.props,j({options:s,items:s,value:o,selectedItems:i?d:d[0]},t)))];case 1:return c=h.sent(),[2,!!(c!=null&&c.prevented)]}})})},a.prototype.isParentNode=function(e){return Array.isArray(e.children)&&e.children.length>0},a.prototype.handleOutClick=function(e){var t;e.stopPropagation(),this.outTargetWidth=(t=this.outTarget.current)===null||t===void 0?void 0:t.clientWidth,e.defaultPrevented||this.setState(function(n){return{isOpened:!n.isOpened}})},a.prototype.handleResultClear=function(){this.setState({inputValue:void 0})},a.prototype.close=function(){this.setState({isOpened:!1})},a.prototype.removeItem=function(e,t){return A(this,void 0,void 0,function(){var n,r,s,i,o;return I(this,function(d){switch(d.label){case 0:return n=this.props,r=n.onChange,s=n.selectedOptions,t&&t.stopPropagation(),s.splice(e,1),i=this.getValue(),[4,this.dispatchEvent("change",{value:i})];case 1:return o=d.sent(),o||r(i),[2]}})})},a.prototype.renderValue=function(e,t){var n=this.props,r=n.classnames,s=n.labelField,i=n.valueField,o=n.options,d=n.hideNodePathLabel,c=this.state.inputValue||"",h=Q(c);if(d)return M(e[s||"label"]);var u=q(o,e,!0),f=M(e[s||"label"]),m=" / ",x=u?u.map(function(N){return M(N[s||"label"])}).join(m):f;return C("span",{className:r("Select-valueLabel"),title:x,children:u?u.map(function(N,_){var y=M(N[s||"label"]),g=N[i||"value"],V=_===u.length-1;return D("span",{children:[h.test(g)||h.test(y)?Se(y,c):y,!V&&m]},_)}):f},t||e[i||"value"])},a.prototype.handleOptionClick=function(e){return A(this,void 0,void 0,function(){var t,n,r,s,i,o,d,c,h;return I(this,function(u){switch(u.label){case 0:return t=this.props,n=t.multiple,r=t.onChange,s=t.joinValues,i=t.extractValue,o=t.valueField,d=t.onlyLeaf,n?[2]:(c=s||i?e[o||"value"]:e,c===void 0?[2]:d&&this.isParentNode(e)?[2]:[4,this.dispatchEvent("change",{value:c})]);case 1:return h=u.sent(),h||r(c),h||this.handleResultClear(),this.setState({stack:[this.props.options]}),this.close(),[2]}})})},a.prototype.handleCheck=function(e,t,n){return A(this,void 0,void 0,function(){var r,s,i,o,d,c,h,u,f,m,x,N,_,y,g,V,w,w,v,p,S,O;return I(this,function(P){switch(P.label){case 0:if(r=this.props,s=r.onChange,i=r.selectedOptions,o=r.joinValues,d=r.delimiter,c=r.extractValue,h=r.withChildren,u=r.onlyChildren,f=r.cascade,m=r.options,x=r.onlyLeaf,N=this.state.stack,_=this.props.valueField||"value",x&&!Array.isArray(e)&&this.isParentNode(e))return[2];if(!Array.isArray(e)&&e.children&&e.children.length&&typeof t=="number"&&(N[t]?N.splice(t+1,1,e.children):N.push(e.children)),y=i,V=function(b){return Pe(K(Array.isArray(b)?b:[b],function(R){return R.children&&R.children.length?null:R}))},Array.isArray(e)?(h?e=K(e):u&&(e=V(e)),g=y.length===e.length?[]:e):Array.isArray(e.children)?f?g=U(y,[e]):h?(e=K([e]),w=e.every(function(b){return!!~y.indexOf(b)}),g=(w?U:ee)(y,e)):u?(e=V(e),w=e.every(function(b){return!!~y.indexOf(b)}),g=(w?U:ee)(y,e)):(g=y.filter(function(b){return!~K([e]).indexOf(b)}),!~y.indexOf(e)&&g.push(e)):g=U(y,[e]),!f)for(v=e;;){if(p=Fe(m,v),p!=null&&p.value&&p.children.every(function(b){return~g.indexOf(b)})){p.children.forEach(function(b){var R=g.indexOf(b);~R&&!h&&!u&&g.splice(R,1)}),u||g.push(p),v=p;continue}break}return S=o?g.map(function(b){return b[_]}).join(d):c?g.map(function(b){return b[_]}):g,[4,this.dispatchEvent("change",{value:S})];case 1:return O=P.sent(),O||s(S),O||this.handleResultClear(),n&&this.setState({stack:[this.props.options]}),[2]}})})},a.prototype.allChecked=function(e){var t=this,n=this.props,r=n.selectedOptions,s=n.withChildren,i=n.onlyChildren;return e.every(function(o){return(s||i)&&o.children?t.allChecked(o.children):r.some(function(d){return d===o})})},a.prototype.partialChecked=function(e){var t=this;return e.some(function(n){var r=n.children&&t.partialChecked(n.children);return r||t.props.selectedOptions.some(function(s){return s===n})})},a.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},a.prototype.getValue=function(){var e=this.props,t=e.selectedOptions,n=e.joinValues,r=e.valueField,s=e.extractValue,i=e.delimiter,o=e.value;return n?o=t.map(function(d){return d[r||"value"]}).join(i||","):s&&(o=t.map(function(d){return d[r||"value"]})),o},a.prototype.onFocus=function(e){return A(this,void 0,void 0,function(){var t,n,r,s,i;return I(this,function(o){switch(o.label){case 0:return t=this.props,n=t.onFocus,r=t.disabled,s=this.getValue(),!r&&!this.state.isOpened?(this.setState({isFocused:!0}),[4,this.dispatchEvent("focus",{value:s})]):[3,2];case 1:i=o.sent(),i||n&&n(e),o.label=2;case 2:return[2]}})})},a.prototype.onBlur=function(e){return A(this,void 0,void 0,function(){var t,n,r;return I(this,function(s){switch(s.label){case 0:return t=this.props.onBlur,n=this.getValue(),this.setState({isFocused:!1}),[4,this.dispatchEvent("blur",{value:n})];case 1:return r=s.sent(),r||t&&t(e),[2]}})})},a.prototype.getTarget=function(){return this.target||(this.target=X.findDOMNode(this)),this.target},a.prototype.handleKeyPress=function(e){e.key===" "&&(this.handleOutClick(e),e.preventDefault())},a.prototype.handleInputKeyDown=function(e){var t=this.state.inputValue,n=this.props,r=n.multiple,s=n.selectedOptions;e.key==="Backspace"&&!t&&s.length&&r&&this.removeItem(s.length-1)},a.prototype.handleInputChange=function(e){var t=this.props,n=t.options,r=t.labelField,s=t.valueField,i=e&&this.state.isOpened?de(n,function(o,d,c,h){return!!Z([o].concat(h),e,{keys:[r||"label",s||"value"],threshold:Z.rankings.CONTAINS}).length||!!(o.children&&o.children.length)},1,!0):n.concat();this.setState({inputValue:e,stack:[i]})},a.prototype.handleResultChange=function(e){return A(this,void 0,void 0,function(){var t,n,r,s,i,o,d,c,h,u;return I(this,function(f){switch(f.label){case 0:return t=this.props,n=t.joinValues,r=t.extractValue,s=t.delimiter,i=t.valueField,o=t.onChange,d=t.multiple,c=Array.isArray(e)?e.concat():[],!d&&!c.length?[4,this.dispatchEvent("change",{value:""})]:[3,2];case 1:return h=f.sent(),h||o(""),[2];case 2:return(n||r)&&(c=e.map(function(m){return m[i||"value"]})),n&&(c=c.join(s||",")),[4,this.dispatchEvent("change",{value:c})];case 3:return u=f.sent(),u||o(c),[2]}})})},a.prototype.getMenuSelectMenuStyle=function(){var e=this.props.options,t=this.outTargetWidth,n=ce(e),r={};return t&&(r={width:t/n}),r},a.prototype.renderOptions=function(){var e=this,t=this.props,n=t.multiple,r=t.selectedOptions,s=t.classnames,i=t.options,o=t.disabled,d=t.checkAll,c=t.checkAllLabel,h=t.translate,u=t.labelField,f=t.menuClassName,m=t.cascade,x=t.onlyChildren,N=t.testIdBuilder,_=this.props.valueField||"value",y=this.state.stack,g=this.partialChecked(i),V=this.allChecked(i);return C(ue,{children:y.map(function(w,v){return D("div",{className:s("NestedSelect-menu",f),style:e.getMenuSelectMenuStyle(),children:[n&&d&&v===0?D("div",{className:s("NestedSelect-option","checkall"),children:[C(Y,{size:"sm",onChange:e.handleCheck.bind(e,w),checked:g,partial:g&&!V}),C("span",{onClick:e.handleCheck.bind(e,w),children:h(c)})]}):null,w.map(function(p,S){var O=N==null?void 0:N.getChild("menu-".concat(v)).getChild(p.value||S),P=q(i,p),b=P==null?void 0:P.some(function($){return!!~r.indexOf($)}),R=m?!1:n&&b,E=P==null?void 0:P.some(function($){return!!$.disabled}),B=R||p.disabled||E||!!o,z=!!(p.children&&e.partialChecked(p.children)),L=R||!!~r.indexOf(p);!L&&x&&n&&e.isParentNode(p)&&e.allChecked(p.children)&&(L=!0);var J=M(p[u||"label"]);return D("div",{className:s("NestedSelect-option",{"is-active":!B&&(L||!m&&z)}),onMouseEnter:e.onMouseEnter.bind(e,p,v),children:[n?C(Y,{size:"sm",onChange:e.handleCheck.bind(e,p,v,!1),trueValue:p[_],checked:L||!m&&z,partial:!L,disabled:B,testIdBuilder:O==null?void 0:O.getChild("checkbox")}):null,C("div",{...j({className:s("NestedSelect-optionLabel",{"is-disabled":B}),onClick:function(){return!B&&(n?e.handleCheck(p,v):e.handleOptionClick(p))},title:J},O==null?void 0:O.getTestId()),children:J}),p.children&&p.children.length?C("div",{...j({className:s("NestedSelect-optionArrowRight",{"is-disabled":B})},O==null?void 0:O.getChild("arrow-right").getTestId()),children:C(he,{icon:"right-arrow-bold",className:"icon"})}):null]},S)})]},v)})})},a.prototype.renderSearchResult=function(){var e=this,t=this.state,n=t.stack,r=t.inputValue,s=this.props,i=s.classnames,o=s.translate,d=s.options,c=s.labelField,h=s.valueField,u=s.cascade,f=s.selectedOptions,m=s.multiple,x=s.disabled,N=s.onlyChildren,_=s.render,y=this.props.noResultsText;y&&(y=_("noResultText",o(y)));var g=Q(r||""),V=K(n[0]).filter(function(v){return!!(g.test(v[h||"value"])||g.test(v[c||"label"]))}),w=C("div",{className:i("NestedSelect-menu"),style:this.getMenuSelectMenuStyle(),children:V.length?V.map(function(v,p){var S=q(d,v),O=u?!1:m&&(S==null?void 0:S.some(function(E){return!!~f.indexOf(E)})),P=O||v.disabled||!!x||(S==null?void 0:S.some(function(E){return!!E.disabled})),b=!!(v.children&&e.partialChecked(v.children)),R=O||!!~f.indexOf(v);return!R&&N&&e.isParentNode(v)&&e.allChecked(v.children)&&(R=!0),C("div",{className:i("NestedSelect-option",{"is-active":!P&&(R||!u&&b)}),children:C("div",{className:i("NestedSelect-optionLabel",{"is-disabled":P}),onClick:function(){!P&&(m?e.handleCheck(v,v.value,!0):e.handleOptionClick(v))},children:e.renderValue(v,v.value)})},p)}):C("div",{className:i("NestedSelect-option",{"no-result":!0}),children:y})});return w},a.prototype.onMouseEnter=function(e,t,n){var r=this.state.stack;t=t+1;var s=e.children;s&&s.length?r[t]?r.splice(t,1,s):r.push(s):r[t]&&r.splice(t,1),this.setState({stack:r.slice(0,t+1)})},a.prototype.renderOuter=function(){var e=this,t=this.props,n=t.popOverContainer,r=t.translate,s=t.classnames,i=t.options,o=t.render,d=t.id,c=t.themeCss,h=!!this.state.inputValue,u=this.props.noResultsText;u&&(u=o("noResultText",r(u)));var f=C(pe,{disabled:!this.state.isOpened,onRootClose:this.close,children:function(m){return C("div",{className:s("NestedSelect-menuOuter"),ref:m,children:h?e.renderSearchResult():i.length?e.renderOptions():C("div",{className:s("NestedSelect-noResult"),children:u})})}});return C(ve,{target:this.getTarget,container:n||function(){return X.findDOMNode(e)},placement:"auto",show:!0,children:C(fe,{className:s("NestedSelect-popover",G(j(j({},this.props),{name:"nestedSelectPopoverClassName",id:d,themeCss:c}))),children:f})})},a.prototype.render=function(){var e,t=this.props,n=t.className,r=t.style,s=t.disabled,i=t.classnames,o=t.multiple,d=t.placeholder,c=t.translate,h=t.inline,u=t.searchable,f=t.selectedOptions,m=t.clearable,x=t.loading,N=t.borderMode,_=t.mobileUI;t.popOverContainer;var y=t.env,g=t.testIdBuilder,V=t.loadingConfig,w=t.maxTagCount,v=t.overflowTagPopover,p=this.props,S=p.classPrefix,O=p.themeCss,P=p.id;return D("div",{className:i("NestedSelectControl",n),ref:this.outTarget,style:r,children:[C(ye,{mobileUI:_,maxTagCount:w,overflowTagPopover:v,disabled:s,ref:this.domRef,placeholder:c(d??"placeholder.empty"),inputPlaceholder:"",className:i("NestedSelect",(e={"NestedSelect--inline":h,"NestedSelect--single":!o,"NestedSelect--multi":o,"NestedSelect--searchable":u,"is-opened":this.state.isOpened,"is-focused":this.state.isFocused},e["NestedSelect--border".concat(ge(N))]=N,e),G(j(j({},this.props),{name:"nestedSelectControlClassName",id:P,themeCss:O}))),result:o?f:f.length?f[0]:"",onResultClick:this.handleOutClick,value:this.state.inputValue,onChange:this.handleInputChange,onResultChange:this.handleResultChange,onClear:this.handleResultClear,itemRender:this.renderValue,onKeyPress:this.handleKeyPress,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.handleInputKeyDown,clearable:m,hasDropDownArrow:!0,allowInput:u&&!_,testIdBuilder:g,children:x?C(me,{loadingConfig:V,size:"sm"}):void 0}),_?C(Ce,{className:i("NestedSelect-popup"),container:y.getModalContainer,isShow:this.state.isOpened,onHide:this.close,showConfirm:!1,showClose:!1,children:C(be,{...j({onClose:this.close},this.props,{onChange:this.handleResultChange,options:this.props.options.slice(),value:f})})}):this.state.isOpened?this.renderOuter():null,C(ke,{...j({},this.props,{config:{themeCss:O,classNames:[{key:"nestedSelectControlClassName",weights:{hover:{suf:".is-clickable:not(.is-disabled)"},focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"nestedSelectPopoverClassName",weights:{default:{suf:" .".concat(S,"NestedSelect-option")},hover:{suf:" .".concat(S,"NestedSelect-option.is-highlight")},focused:{inner:".".concat(S,"NestedSelect-option.is-active")}}}],id:P},env:y})})]})},a.defaultProps={cascade:!1,withChildren:!1,onlyChildren:!1,onlyLeaf:!1,searchPromptText:"Select.searchPromptText",noResultsText:"noResult",checkAll:!0,checkAllLabel:"Select.checkAll",hideNodePathLabel:!1},k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"domRef",null),k([F,l("design:type",Function),l("design:paramtypes",[String,Object]),l("design:returntype",Promise)],a.prototype,"dispatchEvent",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"handleOutClick",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"handleResultClear",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"close",null),k([F,l("design:type",Function),l("design:paramtypes",[Object,Object]),l("design:returntype",void 0)],a.prototype,"renderValue",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],a.prototype,"handleOptionClick",null),k([F,l("design:type",Function),l("design:paramtypes",[Object,Number,Boolean]),l("design:returntype",Promise)],a.prototype,"handleCheck",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"getValue",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],a.prototype,"onFocus",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],a.prototype,"onBlur",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"getTarget",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"handleKeyPress",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"handleInputKeyDown",null),k([F,l("design:type",Function),l("design:paramtypes",[String]),l("design:returntype",void 0)],a.prototype,"handleInputChange",null),k([F,l("design:type",Function),l("design:paramtypes",[Array]),l("design:returntype",Promise)],a.prototype,"handleResultChange",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"getMenuSelectMenuStyle",null),k([Oe(),l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"render",null),a}(H.Component),Ae=function(T){W(a,T);function a(){return T!==null&&T.apply(this,arguments)||this}return a=k([te({type:"nested-select"})],a),a}(se),Ie=function(T){W(a,T);function a(){return T!==null&&T.apply(this,arguments)||this}return a=k([te({type:"cascader-select"})],a),a}(se);export{Ie as CascaderSelectControlRenderer,Ae as NestedSelectControlRenderer,se as default};

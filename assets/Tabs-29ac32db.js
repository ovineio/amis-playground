import{a as fe,al as V,r as B,aj as W,as as ge,d as y,aq as se,a4 as Ce,az as ue,J as x,h as ne,k as ie,c$ as Ke,n as ce,j,U as z,E as he,a5 as ve,c8 as pe,K as G,V as re,l as Ne,F as Ae,c7 as Se,e as b,p as K,q as c,R as _e,s as Ee,f as we,d0 as Oe,Y as ye,c9 as Fe}from"./index-12050af9.js";var Ie=function(M){fe(l,M);function l(e){var t=M.call(this,e)||this;t.newTabDefaultId=3;var a=e.location||window.location,n=e.tabs,i=e.source,o=e.data,r=0;if(typeof e.activeKey<"u")r=e.activeKey;else if(a&&Array.isArray(n)){var h=a.hash.substring(1),u=V(n,function(N){return N.hash===h});u?r=u.hash:e.defaultKey!==void 0?r=typeof e.defaultKey=="string"?B(e.defaultKey,e.data):e.defaultKey:e.defaultActiveKey&&(r=typeof e.defaultActiveKey=="string"?B(e.defaultActiveKey,e.data):e.defaultActiveKey),r=r||n[0]&&n[0].hash||0}var p=W(t.initTabArray(n,i,o),2),v=p[0],T=p[1];return t.state={prevKey:void 0,activeKey:t.activeKey=r,localTabs:v,isFromSource:T},t}return l.prototype.initTabArray=function(e,t,a){if(!e)return[[],!1];var n=B(t,a,"| raw");if(!Array.isArray(n))return[e,!1];e=Array.isArray(e)?e:[e];var i=[];return n.forEach(function(o){i.push.apply(i,ge([],W(e.map(function(r){return y(y({},r),{data:o})})),!1))}),[i,!0]},l.prototype.componentDidMount=function(){var e,t;this.autoJumpToNeighbour(this.activeKey);var a=this.props,n=a.name,i=a.value,o=a.onChange,r=a.source;a.tabs;var h=a.data,u=this.state.localTabs;if(!(!n||typeof o!="function"||r))if(i=i??se(h,n),i&&Array.isArray(u)){var p=this.resolveKeyByValue(i);p!==void 0&&this.handleSelect(p)}else{var v=this.resolveTabByKey(this.activeKey);v&&i!==((e=v.value)!==null&&e!==void 0?e:v.title)&&o((t=v.value)!==null&&t!==void 0?t:v.title,n)}},l.prototype.componentDidUpdate=function(e,t){var a,n,i,o=this.props,r=this.state.localTabs,h=B(e.defaultActiveKey,e.data),u=B(o.defaultActiveKey,o.data),p=Ce({tabs:o.tabs,source:B(o.source,o.data,"| raw")},{tabs:e.tabs,source:B(e.source,e.data,"| raw")},!1);if(p){var v=W(this.initTabArray(o.tabs,o.source,o.data),2),T=v[0],N=v[1];this.setState({localTabs:T,isFromSource:N}),r=T}if(o.location&&e.location&&o.location.hash!==e.location.hash){var _=o.location.hash.substring(1);if(!_)return;var f=V(r,function(O){return O.hash===_});f&&f.hash&&f.hash!==this.state.activeKey&&this.setState({activeKey:this.activeKey=f.hash,prevKey:this.state.activeKey})}else if(Array.isArray(r)&&Array.isArray(t.localTabs)&&JSON.stringify(r.map(function(O){return O.hash}))!==JSON.stringify(t.localTabs.map(function(O){return O.hash}))){var A=this.state.activeKey,U=o.location,f=null;if(U&&Array.isArray(r)){var J=U.hash.substring(1);f=V(r,function(S){return S.hash===J})}f?A=f.hash:(!r||!r.some(function(S,Q){return S.hash?S.hash===A:Q===A}))&&(A=r&&r[0]&&r[0].hash||0),this.setState({prevKey:void 0,activeKey:this.activeKey=A})}else if(h!==u){if(u==null)return;var E=null,f=V(r,function(S){return S.hash===u});f?E=f.hash:typeof u=="number"&&r[u]&&(E=u),E!==null&&this.setState({prevKey:h,activeKey:this.activeKey=E})}this.autoJumpToNeighbour(this.activeKey);var w=this.props,H=w.name,g=w.value,k=w.onChange,Y=w.source,$=w.data;if(!(!H||typeof k!="function"||Y)){var R;g=g??se($,H);var P=(a=e.value)!==null&&a!==void 0?a:se(e.data,e.name);if(g!==P&&(R=this.resolveKeyByValue(g))!==void 0&&R!==this.activeKey)this.handleSelect(R);else if(this.activeKey!==t.activeKey){var f=this.resolveTabByKey(this.activeKey);f&&g!==((n=f.value)!==null&&n!==void 0?n:f.title)&&k((i=f.value)!==null&&i!==void 0?i:f.title,H)}}},l.prototype.resolveTabByKey=function(e){var t=this.state.localTabs;if(Array.isArray(t))return V(t,function(a,n){return a.hash?a.hash===e:n===e})},l.prototype.resolveKeyByValue=function(e){var t=this.state.localTabs;if(Array.isArray(t)){var a=V(t,function(n){var i;return((i=n.value)!==null&&i!==void 0?i:n.title)===e});return a&&a.hash?a.hash:t.indexOf(a)}},l.prototype.autoJumpToNeighbour=function(e){var t=this.props;t.tabs;var a=t.data,n=this.state.localTabs;if(Array.isArray(n)){var i=ue(n,function(p,v){return p.hash?p.hash===e:v===e});if(n[i]&&!x(n[i],this.props.data))for(var o=n.length,r=i,h=i;r-->=0||h++<o;){var u=null;if(r>=0&&x(n[r],a)?u=n[r].hash||r:h<o&&x(n[h],a)&&(u=n[h].hash||h),u!==null){this.setState({activeKey:this.activeKey=u});break}}}},l.prototype.handleAdd=function(){var e=this,t=this.state.localTabs.concat();t.push({title:"tab".concat(this.newTabDefaultId++),body:"tab"}),this.setState({localTabs:t},function(){e.switchTo(e.state.localTabs.length-1)})},l.prototype.handleClose=function(e,t){return ne(this,void 0,void 0,function(){var a,n,i,o;return ie(this,function(r){switch(r.label){case 0:return a=this.state.localTabs.concat(),n=a==null?void 0:a.findIndex(function(h,u){var p;return e===(t?h.hash:(p=h.hash)!==null&&p!==void 0?p:u)}),n===-1?[2]:(a.splice(n,1),i=this.props.dispatchEvent,[4,i("delete",ye(this.props,{value:e}))]);case 1:return o=r.sent(),o!=null&&o.prevented?[2]:(this.setState({localTabs:a}),[2])}})})},l.prototype.handleEdit=function(e,t){var a=this.state.localTabs.concat();a[e].title=t,this.setState({localTabs:a})},l.prototype.handleDragChange=function(e){return ne(this,void 0,void 0,function(){var t,a,n=this;return ie(this,function(i){return t=this.resolveTabByKey(this.activeKey),a=this.state.localTabs.concat(),a.splice(e.newIndex,0,a.splice(e.oldIndex,1)[0]),this.setState({localTabs:a},function(){if(t){var o=a.indexOf(t);n.switchTo(o)}}),[2]})})},l.prototype.handleSelect=function(e){var t;return ne(this,void 0,void 0,function(){var a,n,i,o,r,h,u,p,v;return ie(this,function(T){switch(T.label){case 0:return a=this.props,n=a.dispatchEvent,a.data,i=a.env,o=a.onSelect,r=a.id,h=this.state.localTabs,u=h==null?void 0:h.find(function(N,_){return e===(N.hash?N.hash:_)}),u?((t=i.tracker)===null||t===void 0||t.call(i,{eventType:"tabChange",eventData:{id:r,key:e}}),[4,n("change",ye(this.props,{value:u!=null&&u.hash?u==null?void 0:u.hash:e+1}))]):[2];case 1:return p=T.sent(),p!=null&&p.prevented?[2]:(typeof e=="string"&&i?i.updateLocation("#".concat(e)):typeof this.state.activeKey=="string"&&i&&i.updateLocation("#"),this.setState({activeKey:this.activeKey=e,prevKey:this.state.activeKey}),typeof o=="string"?(v=Fe(o,"key","props"),v&&v(e,this.props)):typeof o=="function"&&o(e,this.props),[2])}})})},l.prototype.doAction=function(e,t,a,n){var i=e==null?void 0:e.actionType,o=Number(n==null?void 0:n.activeKey),r=Ke(o)?n==null?void 0:n.activeKey:o,h=n==null?void 0:n.deleteHash;i==="changeActiveKey"?this.handleSelect(typeof r=="number"?r-1:r):i==="deleteTab"&&this.handleClose(h,!0)},l.prototype.switchTo=function(e){var t=this.state.localTabs;Array.isArray(t)&&t[e]&&this.setState({activeKey:this.activeKey=t[e].hash||e})},l.prototype.currentIndex=function(){var e=this,t=this.state.localTabs;return Array.isArray(t)?ue(t,function(a,n){return a.hash?a.hash===e.state.activeKey:n===e.state.activeKey}):-1},l.prototype.renderTabTitle=function(e,t,a){var n=this.props.render;return typeof e=="string"||!e?ce(e,a):n("tab-title/".concat(t),e,{data:y({index:t,__index:t},a)})},l.prototype.renderToolbar=function(){var e=this.props,t=e.toolbar,a=e.render,n=e.classnames,i=e.toolbarClassName,o=e.id,r=e.themeCss;return t?j("div",{className:n("Tabs-toolbar",i,z(y(y({},this.props),{name:"toolbarControlClassName",id:o,themeCss:r}))),children:a("toolbar",t)}):null},l.prototype.renderTabs=function(){var e=this,t=this.props,a=t.classnames,n=t.classPrefix,i=t.contentClassName,o=t.linksClassName,r=t.tabRender,h=t.className,u=t.style,p=t.render,v=t.data,T=t.mode,N=t.tabsMode,_=t.unmountOnExit;t.source;var f=t.formStore,A=t.formMode,U=t.formHorizontal,J=t.subFormMode,E=t.subFormHorizontal,w=t.addable,H=t.closable,g=t.draggable,k=t.showTip,Y=t.showTipClassName,$=t.editable,R=t.sidePosition,P=t.translate,O=t.addBtnText,S=t.collapseOnExceed,Q=t.collapseBtnLabel,L=t.disabled,X=t.mobileUI,oe=t.swipeable,F=t.testIdBuilder,q=t.id,le=t.wrapperCustomStyle,Z=t.themeCss,me=t.env,be=N||T,ee=this.props.mountOnEnter;f&&(ee=!1);var de=this.state,m=de.localTabs,Te=de.isFromSource,te=[],ae=[];return Te?(te=m.map(function(s,d){var C,I,D=he(v,ve(s.data)?y({index:d},s.data):{item:s.data,index:d});return x(s,D)?j(pe,{...y({},s,{title:e.renderTabTitle(s.title,d,D),disabled:L||G(s,D),key:d,eventKey:ce(s.hash,D)||d,prevKey:d>0?((C=m[d-1])===null||C===void 0?void 0:C.hash)||d-1:0,nextKey:d<m.length-1?((I=m[d+1])===null||I===void 0?void 0:I.hash)||d+1:m.length-1,swipeable:oe,mobileUI:X,mountOnEnter:ee,unmountOnExit:typeof s.reload=="boolean"?s.reload:typeof s.unmountOnExit=="boolean"?s.unmountOnExit:_,onSelect:e.handleSelect,testIdBuilder:F==null?void 0:F.getChild("tab-".concat(typeof s.title=="string"?s.title:d)),className:a(s.className,z(y(y({},s),{name:"panelControlClassName",id:s.id,themeCss:s.themeCss})))}),children:p("item/".concat(d),s!=null&&s.type?s:s.tab||s.body,{disabled:L||G(s,D)||void 0,data:D,formMode:s.mode||J||A,formHorizontal:s.horizontal||E||U})}):null}),ae=m.map(function(s,d){var C=he(v,ve(s.data)?y({index:d},s.data):{item:s.data,index:d});return x(s,C)?j(re,{...y({},s,{config:{id:s.id,themeCss:s.themeCss,classNames:[{key:"panelControlClassName"}]},env:e.props.env,key:"customstyle_".concat(d)})}):null})):(te=m.map(function(s,d){var C,I;return x(s,v)?j(pe,{...y({},s,{title:e.renderTabTitle(s.title,d,v),disabled:L||G(s,v),key:d,eventKey:s.hash||d,prevKey:d>0?((C=m[d-1])===null||C===void 0?void 0:C.hash)||d-1:0,nextKey:d<m.length-1?((I=m[d+1])===null||I===void 0?void 0:I.hash)||d+1:m.length-1,swipeable:oe,mobileUI:X,mountOnEnter:ee,unmountOnExit:typeof s.reload=="boolean"?s.reload:typeof s.unmountOnExit=="boolean"?s.unmountOnExit:_,onSelect:e.handleSelect,testIdBuilder:F==null?void 0:F.getChild("tab-".concat(typeof s.title=="string"?s.title:d)),className:a(s.className,z(y(y({},s),{name:"panelControlClassName",id:s.id,themeCss:s.themeCss})))}),children:e.renderTab?e.renderTab(s,e.props,d):r?r(s,e.props,d):p("tab/".concat(d),s!=null&&s.type?s:s.tab||s.body,{disabled:L||G(s,v)||void 0,formMode:s.mode||J||A,formHorizontal:s.horizontal||E||U})}):null}),ae=m.map(function(s,d){return x(s,v)?j(re,{config:{id:s.id,themeCss:s.themeCss,classNames:[{key:"panelControlClassName"}]},env:e.props.env},"customstyle_".concat(d)):null})),Ne(Ae,{children:[j(Se,{addBtnText:P(O||"add"),classPrefix:n,classnames:a,mode:be,closable:H,className:a(h,z(y(y({},this.props),{name:"wrapperCustomStyle",id:q,themeCss:le}))),style:u,contentClassName:a(i,z(y(y({},this.props),{name:"contentControlClassName",id:q,themeCss:Z}))),linksClassName:o,titleClassName:a(z(y(y({},this.props),{name:"titleControlClassName",id:q,themeCss:Z}))),onSelect:this.handleSelect,activeKey:this.state.activeKey,toolbar:this.renderToolbar(),addable:w,onAdd:this.handleAdd,onClose:this.handleClose,draggable:g,onDragChange:this.handleDragChange,showTip:k,showTipClassName:Y,editable:$,onEdit:this.handleEdit,sidePosition:R,collapseOnExceed:S,collapseBtnLabel:Q,mobileUI:X,testIdBuilder:F,children:te}),ae,j(re,{...y({},this.props,{config:{wrapperCustomStyle:le,id:q,themeCss:Z,classNames:[{key:"titleControlClassName",weights:{default:{important:!0,inner:"> a"},focused:{important:!0,suf:".is-active",inner:"> a"},hover:{important:!0,inner:"> a"},disabled:{important:!0,suf:".is-disabled",inner:"> a"}}},{key:"toolbarControlClassName",weights:{default:{important:!0}}},{key:"contentControlClassName",weights:{default:{important:!0}}}]},env:me})})]})},l.prototype.render=function(){return this.renderTabs()},l.defaultProps={className:"",mode:"",mountOnEnter:!0,unmountOnExit:!1},b([K,c("design:type",Function),c("design:paramtypes",[Array,String,Object]),c("design:returntype",Array)],l.prototype,"initTabArray",null),b([K,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",void 0)],l.prototype,"autoJumpToNeighbour",null),b([K,c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",void 0)],l.prototype,"handleAdd",null),b([K,c("design:type",Function),c("design:paramtypes",[Object,Boolean]),c("design:returntype",Promise)],l.prototype,"handleClose",null),b([K,c("design:type",Function),c("design:paramtypes",[Number,String]),c("design:returntype",void 0)],l.prototype,"handleEdit",null),b([K,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],l.prototype,"handleDragChange",null),b([K,c("design:type",Function),c("design:paramtypes",[Object]),c("design:returntype",Promise)],l.prototype,"handleSelect",null),b([K,c("design:type",Function),c("design:paramtypes",[Number]),c("design:returntype",void 0)],l.prototype,"switchTo",null),b([K,c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",Number)],l.prototype,"currentIndex",null),l}(_e.Component),xe=function(M){fe(l,M);function l(e,t){var a=M.call(this,e)||this,n=t;return n.registerComponent(a),a}return l.prototype.componentWillUnmount=function(){var e;(e=M.prototype.componentWillUnmount)===null||e===void 0||e.call(this);var t=this.context;t.unRegisterComponent(this)},l.contextType=Ee,l=b([we({type:"tabs",onGlobalVarChanged:function(e,t,a){if(Oe(t.source)){var n=W(e.initTabArray(e.props.tabs,e.props.source,a),2),i=n[0],o=n[1];return e.setState({localTabs:i,isFromSource:o}),!1}}}),c("design:paramtypes",[Object,Object])],l),l}(Ie);export{xe as TabsRenderer,Ie as default};
